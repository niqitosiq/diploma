React — это библиотека JavaScript, разработанная компанией Facebook для создания пользовательских интерфейсов. С момента своего создания в 2013 году, React зарекомендовал себя как мощный инструмент для разработки сложных и высокопроизводительных веб-приложений. В данной главе мы более подробно рассмотрим основные концепции React и методы отрисовки, которые она использует.

### **2.1. Основные концепции React**

React основан на концепции компонентов. Компонент в React — это независимый и переиспользуемый код, который отвечает за отображение определенной части интерфейса. Компоненты в React могут быть функциональными или классовыми, причем сегодня в большинстве случаев используются функциональные компоненты, которые позволяют использовать такие возможности React, как хуки.

React использует виртуальный DOM (Document Object Model), который является легковесной копией реального DOM. При изменении состояния компонента, React сначала обновляет виртуальный DOM, а затем сравнивает его с реальным DOM, чтобы определить, какие изменения необходимо произвести. Этот процесс называется "согласованием" (reconciliation) и он позволяет React оптимизировать обновления DOM и повысить производительность.

### **2.2. Методы отрисовки в React**

Процесс отрисовки в React включает в себя несколько этапов:

1.  **Монтирование (Mounting)**: Этап, на котором компонент создается и вставляется в DOM.
2.  **Обновление (Updating)**: На этом этапе компонент может быть обновлен в результате изменения состояния или пропсов.
3.  **Размонтирование (Unmounting)**: Этап, на котором компонент удаляется из DOM.

В каждом из этих этапов React предоставляет специальные методы жизненного цикла, которые можно использовать для выполнения различных действий. Например, в классовых компонентах это могут быть методы `componentDidMount`, `componentDidUpdate`, `componentWillUnmount` и др.

В функциональных компонентах React для управления жизненным циклом используются хуки, такие как `useEffect` и `useState`. Хук `useEffect` позволяет выполнять побочные эффекты в функциональном компоненте, включая работу с подписями, запросами к API, таймерами и т.д. `useState` предоставляет возможность добавить состояние к функциональному компоненту.

### **2.3. Виртуальный DOM и алгоритм согласования**

Одним из ключевых аспектов, делающих React эффективным инструментом для создания динамических интерфейсов, является использование виртуального DOM и алгоритма согласования.

Виртуальный DOM — это концепция, при которой создается "виртуальная" копия реального DOM, что позволяет React сначала применить изменения к виртуальному DOM, а затем, сравнив его с реальным DOM, определить наиболее эффективный способ применить эти изменения к реальному DOM. Это существенно ускоряет процесс отрисовки, так как операции с реальным DOM требуют значительных затрат ресурсов.

Процесс сравнения виртуального и реального DOM и определения изменений, которые необходимо применить, называется "согласованием". Алгоритм согласования React оптимизирован для максимальной производительности и минимизации операций с DOM.

### **2.4. JSX и рендеринг компонентов**

React использует JSX (JavaScript XML) — это синтаксическое расширение JavaScript, которое позволяет описывать структуру интерфейса непосредственно в коде JavaScript. JSX выглядит подобно HTML, но представляет собой JavaScript-выражения.

Отрисовка компонентов в React происходит с помощью метода `render()` в классовых компонентах или через возвращаемый результат функциональных компонентов. В обоих случаях это JSX-выражение, описывающее, как должен выглядеть компонент.

### **2.5. Алгоритм определения необходимости ререндера компонента в React**

Реакт использует эффективный алгоритм для определения того, требуется ли ререндер компонента. Процесс ререндера инициируется при изменении состояния или пропсов компонента. Когда это происходит, React запускает процесс, который определяет, нужно ли обновлять DOM.

1. **Изменение состояния или пропсов компонента.** Когда состояние или пропсы компонента изменяются, React сравнивает новые и старые значения. Если они различаются, начинается процесс ререндера.

2. **Вызов функции рендера.** React вызывает функцию рендера компонента, которая возвращает новое дерево React-элементов. Код, написанный в теле этой функции, выполняется при каждом вызове.

3. **Сравнение нового и старого деревьев элементов.** React сравнивает новое и старое деревья элементов, используя алгоритм сравнения. Если React находит различия между двумя деревьями, он генерирует список изменений, который нужно применить к DOM.

4. **Обновление DOM.** React применяет список изменений к DOM, обновляя только те части, которые изменились.

Этот алгоритм позволяет React эффективно управлять процессом рендеринга, минимизируя количество обновлений DOM и улучшая производительность приложения.

Однако стоит отметить, что любой код, написанный в теле функции компонента, будет выполняться при каждом ререндере. Это означает, что добавление лишних вычислений или операций в тело функции компонента может замедлить процесс рендеринга и ухудшить производительность приложения. Поэтому важно стараться минимизировать количество вычислений и операций в теле функции компонента, включая использования хуков, которые созданы для оптимизации, поскольку использование хуков является таким же исполнительным кодом, и затрачивают на свою работу память и процессорное время. 
Поэтому при добавлении любого кода в тело функции компонента, стоит помнить о затраченных на его обработку ресурсах и выбирать лучшую альтернативу. Это особенно важно при использовании хуков `useMemo` и `useCallback`, которые будут рассмотрены дальше